<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="independencepvalue">
<title>Tutorial â€¢ independencepvalue</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="independencepvalue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">independencepvalue</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">Tutorial</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ArkajyotiSaha/independencepvalue-project/tree/main/independencepvalue/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ArkajyotiSaha/independencepvalue-project/tree/main/independencepvalue/vignettes/Tutorial.Rmd" class="external-link"><code>vignettes/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    

<p>In this tutorial, we demonstrate how to use <code>independencepvalue</code> to test the independence of a group of variables with the remaining variables of a data set, where that group was obtained by thresholding the correlation matrix.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Let <span class="math inline">\({\bf X}\sim N_{n\times p}(0,{\bf I}_n,{\boldsymbol\Sigma})\)</span>, and let <span class="math inline">\({\bf x}\)</span> be a realization of <span class="math inline">\({\bf X}\)</span>. This package tests if a particular block of the covariance matrix is zero or not, i.e.</p>
<p><span class="math display">\[
H_0^{\mathcal P}:{\boldsymbol\Sigma}_{{\mathcal P},{\mathcal P}^c}={\bf 0}~~\text{versus}~~H_1^{\mathcal P}:{\boldsymbol\Sigma}_{{\mathcal P},{\mathcal P}^c}\neq{\bf 0}.
\]</span></p>
<p>There are two main parts to this package:</p>
<ol style="list-style-type: decimal">
<li><p><strong>P-values in the case of pre-specified groups:</strong> We compute the p-value under the classical context in which <span class="math inline">\({\mathcal P}\)</span> is assumed to be pre-specified (i.e., not selected based on the data used for testing). While this is not the focus of the package, some users may find this useful. Here, we compute the p-value as <span class="math display">\[
p_{classical} = P \left( T({\bf X}) \text{ is more extreme than } T({\bf x}) \text{ under } H_0^{\mathcal P}\right),
\]</span> where <span class="math inline">\(T({\bf X})\)</span> denotes the test statistic corresponding to <span class="math inline">\({\bf X}\)</span>.</p></li>
<li>
<strong>P-values in the case of data-dependent groups:</strong>
<ol style="list-style-type: lower-alpha">
<li>
<strong>Partitioning variables into groups:</strong> Here we implement a straightforward partitioning strategy based on thresholding the absolute values of the entries in the correlation matrix.</li>
<li>
<strong>P-values in the case of selected groups:</strong> This is the heart of the package. It computes p-values in the case that <span class="math inline">\(\hat{\mathcal P}= \hat{\mathcal P}({\bf x})\)</span> is the result of implementing the partitioning in a. on <span class="math inline">\(\mathbf{x}\)</span>. Since in this case, the group of variables is data-dependent, we write our tested hypothesis as <span class="math display">\[
H_0^{\hat{\mathcal P}}:{\boldsymbol\Sigma}_{\hat{\mathcal P},\hat{\mathcal P}^c}={\bf 0}~~\text{versus}~~H_1^{\hat{\mathcal P}}:{\boldsymbol\Sigma}_{\hat{\mathcal P},\hat{\mathcal P}^c}\neq{\bf 0}.
\]</span> Here, while computing the p-value, we only consider the realizations of <span class="math inline">\({\bf X}\)</span> where applying the thresholding in part a. recovers the observed partitioning in data <span class="math inline">\({\bf x}\)</span>, i.e. <span class="math display">\[
p_{selective} = P \left( T({\bf X}) \text{ is more extreme than } T({\bf x}) \text{ under } H_0^\hat{\mathcal P}\bigg| \text{ Applying a. on } {\bf X}\text{ recovers } \hat{\mathcal P}\right).
\]</span>
</li>
</ol>
</li>
</ol>
<p>First, we load <code>independencepvalue</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ArkajyotiSaha/independencepvalue-project/tree/main/independencepvalue" class="external-link">independencepvalue</a></span><span class="op">)</span></span></code></pre></div>
<p>Next, we demonstrate the use of the package on the example we considered in the <a href="articles/Overview.html">Overview</a>. First, we simulate the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_example.html">create_example</a></span><span class="op">(</span><span class="va">p</span>, a <span class="op">=</span> <span class="fl">0.6</span>, b <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9768</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="va">Sigma</span><span class="op">)</span></span></code></pre></div>
<p>Now, we will use thresholding at cutoff <span class="math inline">\(c = 0.5\)</span> on the sample correlation matrix to obtain a partitioning of the variables. We plot the absolute values of the sample correlation matrix, the adjacency matrix obtained by thresholding, and the graph corresponding to the adjacency matrix to show how the groups were obtained:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_diag_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/block_diag.html">block_diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, c<span class="op">=</span><span class="fl">0.5</span>, fig <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/thresholding_alt-1.png" width="900" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_diag_structure</span></span>
<span><span class="co">#&gt; [1] 1 1 1 2 3 3</span></span></code></pre></div>
<p>Next, we test the independence of group <code>1</code> with the remaining variables. First, we use the classical approach:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/classical_p_val.html">classical_p_val</a></span><span class="op">(</span>S<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, CP<span class="op">=</span><span class="va">block_diag_structure</span>, k<span class="op">=</span><span class="fl">1</span>, n<span class="op">=</span><span class="va">n</span>, mc_iter<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.791</span></span></code></pre></div>
<p>As demonstrated in the <a href="articles/Overview.html">Overview</a>, the classical approach fails to reject the null hypothesis and consequently does not identify the group of variables to be correlated with the remaining variables. This primarily happens as the classical inference does not account for the fact that the hypothesis was selected from the data. Our proposed selective inference approach accounts for this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/selective_p_val.html">selective_p_val</a></span><span class="op">(</span>S<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, CP<span class="op">=</span><span class="va">block_diag_structure</span>, k<span class="op">=</span><span class="fl">1</span>, n<span class="op">=</span><span class="va">n</span>, c<span class="op">=</span><span class="fl">0.5</span>, d0<span class="op">=</span><span class="fl">5</span>, mc_iter<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01411965</span></span></code></pre></div>
<p>We observe that the selective approach correctly identifies the group of variables to be correlated with the remaining variables.</p>
<p>Overall the selective inference in <code>independencepvalue</code> has higher power than that of the classical inference while having well-calibrated type-I error (please refer to <a href="XXXX.arxiv.org">Inferring independent sets of Gaussian variables after thresholding correlations</a>). This can play a pivotal role in protecting against the oversimplification of network structures in the fields of genomics, genetics, neuroscience, etc., which in turn can lead to novel discoveries in science.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arkajyoti Saha, Daniela Witten, Jacob Bien.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
